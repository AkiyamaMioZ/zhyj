# 假设 game_id_str 是包含所有 game_id 的多行字符串

import mysql.connector
from datetime import datetime, timedelta
import random
# 配置数据库连接
db_config = {
    'host': 'localhost',          # 数据库主机名
    'user': 'root',      # 数据库用户名
    'password': '123456',  # 数据库密码
    'database': 'steamdb'   # 数据库名称
}
game_id_str = """
10
70
220
240
400
440
500
550
570
730
1840
2280
3330
3590
3900
3910
4000
4570
4580
4700
4760
8500
8800
8930
9420
9450
9900
10090
10180
10500
12120
12210
15620
17480
19680
20920
21690
22320
22330
22370
22380
22490
24200
24780
24790
24800
24810
32470
39140
39210
39500
39510
40970
42700
42960
47410
47890
48190
48700
49520
55150
65980
72850
105450
105600
107410
108600
109600
200210
200260
200510
200710
203160
204360
204880
206440
208650
209000
211500
211820
212200
212500
212680
213610
214490
214950
216150
218230
218620
219740
219990
220200
220240
221040
221100
221380
223470
223710
223750
223850
224260
225540
227300
230290
230410
231430
232090
232890
233450
233860
234140
234330
235460
236110
236390
236850
238960
239140
241930
242050
242760
242920
243470
244210
244450
244850
246420
246620
248390
250900
251060
251570
252490
252530
252950
253710
254700
255710
257350
261550
261640
262060
264710
266840
268500
268650
268850
268910
269210
270150
270880
271590
273110
274190
275850
278080
280640
280680
281990
282070
282800
284160
285920
286160
286690
287390
287450
287700
288390
288470
289070
289650
291550
292030
293760
294100
297000
298050
304050
304240
304390
304930
305620
306130
307690
307780
307950
310950
311210
311690
312060
312660
322170
322330
323190
325610
326460
327030
331470
333640
335240
335300
342350
346110
346900
356190
359320
359550
359870
360430
361420
363090
363150
363970
364360
365360
365590
365670
365960
367500
367520
371970
372000
373420
374320
376210
377160
377840
378760
379430
379720
380600
381210
382310
383120
386110
386180
386360
386940
387290
387990
388080
389430
391220
391540
392110
392160
393380
394360
397540
397900
400040
400750
403640
410340
410900
412220
413150
415200
424840
427410
427520
431240
431730
431960
433340
433850
435150
436150
438100
440900
444090
444200
444640
445220
447020
447040
453480
457140
458750
459820
460930
463530
464920
466130
466170
466560
468920
471710
475150
476600
480490
482730
489520
489630
489830
492720
493340
493520
494840
495420
502520
504230
505460
508440
512550
512900
513710
516750
518790
524220
524660
526870
527230
527430
529340
534380
544730
544810
548430
550650
551170
552500
552990
553520
553850
563560
566560
568220
569480
570940
573090
573100
578080
581320
582010
582160
582660
585420
588430
588650
594570
594650
595520
596590
599140
601150
601510
602960
610080
613100
616720
620980
621060
625960
627690
628070
628890
629520
629760
632360
632470
635260
636040
636480
638970
640820
641990
644930
645630
646570
646910
648800
663090
665300
666140
668580
670290
672680
673610
675010
678950
686810
690830
692850
692890
698780
700330
701160
703080
704270
704450
705210
712100
714010
719040
728530
728880
729040
736220
736590
739630
740130
745920
753640
756800
758190
760160
761890
766570
767560
769560
774171
774801
777130
779340
780310
782330
784080
784150
784950
786520
787480
787860
788100
794260
805550
812140
813230
813780
814370
814380
815370
824270
834530
835570
838350
843380
848450
850170
858810
859580
860510
868360
870780
872410
872790
874400
875210
877280
880940
881020
881100
883710
885970
886250
891040
892970
897330
898920
899440
899770
916440
919640
920210
924970
926990
927380
933110
934700
939400
945360
949230
955900
958260
960090
960170
962130
972660
976310
976730
977400
977950
985810
990080
992300
993090
994280
1005300
1009850
1012880
1013320
1016950
1017180
1020790
1025600
1029690
1029780
1030830
1046930
1048370
1049590
1049800
1054490
1062090
1062520
1063730
1066780
1066890
1069660
1072420
1084160
1084600
1085660
1086940
1088850
1089090
1091500
1092790
1094780
1097150
1097430
1100600
1105510
1106840
1113560
1114150
1118200
1118310
1119730
1121560
1124300
1127400
1127500
1128920
1129580
1139900
1139980
1141530
1142710
1144200
1145360
1147560
1147690
1149620
1150440
1150640
1151340
1151640
1158160
1158310
1158850
1160750
1161580
1167630
1169040
1172380
1172470
1174180
1176470
1180320
1180380
1184370
1188930
1189490
1190000
1197260
1201240
1203220
1203620
1206560
1211020
1213210
1217060
1222140
1222670
1222680
1222700
1227890
1229490
1237970
1238000
1238040
1238810
1238840
1238860
1241100
1244460
1245620
1248130
1249970
1250410
1252780
1256670
1257290
1258080
1259420
1259970
1260320
1262580
1263850
1266630
1267910
1268750
1270580
1272080
1273400
1274570
1276390
1277400
1280930
1281630
1281930
1282100
1283970
1284190
1284210
1286680
1286830
1293830
1295510
1304930
1313140
1324130
1325200
1325860
1326470
1328670
1329410
1330000
1333350
1335200
1336980
1337520
1338770
1351080
1352080
1352330
1353300
1361210
1363080
1364210
1364390
1364780
1366540
1366800
1367080
1367550
1369320
1369630
1371580
1377380
1377580
1382330
1401590
1404850
1407200
1416920
1418630
1419170
1426210
1433140
1435790
1437880
1446780
1447430
1448440
1449690
1449850
1451190
1454400
1455840
1458140
1462040
1465360
1465460
1465470
1466860
1467450
1468260
1468810
1473350
1476970
1477060
1478220
1486350
1488200
1498570
1501750
1504980
1506830
1517290
1522160
1525700
1526490
1527950
1530160
1533390
1535560
1536610
1537830
1546320
1549970
1551360
1557740
1562430
1566690
1569040
1574360
1583320
1584090
1588010
1593350
1593500
1594320
1599340
1601580
1604030
1607250
1611600
1611910
1621690
1623660
1623730
1625450
1631470
1634680
1635450
1637320
1641650
1644320
1649080
1649730
1657630
1659040
1659420
1665460
1669000
1672500
1677280
1677740
1682970
1683150
1686940
1687950
1689500
1690710
1693980
1694420
1708850
1713350
1714040
1716740
1718570
1721470
1731270
1761390
1774580
1778820
1782120
1782210
1782380
1785150
1787090
1790310
1794680
1796790
1797880
1805480
1809540
1811260
1812620
1812820
1815780
1817070
1817190
1818450
1836730
1842810
1846380
1849250
1857090
1859910
1865780
1868140
1874880
1875830
1876890
1877960
1881610
1881700
1888160
1888930
1891700
1898830
1902690
1904540
1905180
1909840
1919590
1920960
1922560
1927780
1928420
1928980
1934680
1937500
1938090
1940340
1942280
1943950
1948280
1948980
1954420
1961460
1966720
1971870
1973530
1973710
1974050
1976440
1977530
1987080
1988550
1995520
1997040
2000950
2003310
2014780
2016590
2050650
2051620
2054970
2064870
2066020
2067920
2069310
2072450
2073850
2074800
2074920
2079120
2080690
2084000
2088570
2108330
2109460
2113850
2131650
2138710
2139460
2140020
2140330
2140510
2141730
2141910
2142790
2144740
2154770
2157560
2161700
2162800
2163330
2167580
2171440
2183900
2186680
2187220
2195250
2203070
2208920
2215430
2221490
2229850
2231380
2239150
2244130
2250040
2252570
2253720
2276930
2281730
2290180
2291060
2315690
2321470
2322010
2322560
2325290
2333480
2334730
2336220
2338770
2344520
2349820
2354000
2357570
2358260
2358720
2361680
2369900
2370570
2375550
2376170
2379780
2380050
2384620
2396910
2399420
2399830
2401970
2406770
2418520
2420110
2420510
2426960
2427700
2437170
2440380
2448970
2449710
2458860
2471100
2484110
2488620
2490990
2494350
2495450
2500750
2515020
2524890
2526380
2527390
2552430
2567870
2582560
2586520
2590150
2594920
2622000
2634890
2641470
2644470
2646460
2668080
2670630
2674290
2683150
2695940
2696050
2698780
2698940
2701510
2707930
2709570
2719030
2719290
2725560
2732960
2739590
2739600
2756770
2757330
2761670
2764370
2772560
2780980
2797340
2808930
2818260
2821800
2826180
2832330
2835570
2840770
2849080
2855560
2878600
2878980
2881650
2892880
2902000
2904000
2918150
2920570
2923300
2933080
2933130
2955300
2961880
2962810
2977660
2989820
3022140
3030580
3035500
3036080
3047030
3052450
3066060
3069470
3070070
3076520
3103840
3107330
3196540
"""  # 省略了完整的内容

# 将字符串中的 game_id 转换为整数列表
game_id_list = list(map(int, game_id_str.split()))

# 配置
user_count = 105  # 共有 105 个用户
ratings_per_user = 3  # 每个用户生成 3 个评分
rating_range = (1, 5)  # 评分范围

# 时间范围设置
start_date = datetime(2023, 1, 1)
end_date = datetime(2024, 11, 11)


# 函数：生成随机日期
def random_date(start, end):
    return start + timedelta(seconds=random.randint(0, int((end - start).total_seconds())))


# 连接到数据库
connection = mysql.connector.connect(**db_config)
cursor = connection.cursor()

# 开始生成并插入数据
for user_id in range(1, user_count + 1):
    for _ in range(ratings_per_user):
        game_id = random.choice(game_id_list)  # 从已有的 game_id 中选择
        rating = random.randint(*rating_range)
        created_at = random_date(start_date, end_date)

        # 插入数据到数据库
        insert_query = (
            "INSERT INTO app01_gamerating (rating, game_id, user_id, created_at) "
            "VALUES (%s, %s, %s, %s)"
        )
        cursor.execute(insert_query, (rating, game_id, user_id, created_at))

# 提交事务
connection.commit()

# 关闭数据库连接
cursor.close()
connection.close()

print("数据插入完成！")
